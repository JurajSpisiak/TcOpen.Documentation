<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Sequencer | TcOpen </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Sequencer | TcOpen ">
    <meta name="generator" content="docfx 2.58.9.0">
    
    <link rel="shortcut icon" href="../../../favicon.png">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc">
    <meta property="docfx:tocrel" content="../../toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <p class="text-logo">TcOpen</p>
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../../../articles/intro.html" title="Articles">Articles</a>
                      </li>
                      <li>
                          <a href="../../../api/index.html" title="API reference">API reference</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <a href="../../intro.html" title="Introduction" class="">Introduction</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Conventions</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../../Conventions/Conventions.html" title="General" class="">General</a>
                          </li>
                          <li class="">
                            <a href="../../Conventions/Component.html" title="Components" class="">Components</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">TcOpen Framework</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">TcoCore</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/Introduction.html" title="Introduction" class="">Introduction</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoContext.html" title="TcoContext" class="">TcoContext</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoObject.html" title="TcoObject" class="">TcoObject</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoTask.html" title="TcoTask" class="">TcoTask</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoState.html" title="TcoState" class="">TcoState</a>
                                </li>
                                <li class="active">
                                  <a href="../../TcOpenFramework/TcoCore/TcoSequencer.html" title="TcoSequencer" class="active">TcoSequencer</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoComponent.html" title="TcoComponent" class="">TcoComponent</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoMessenger.html" title="TcoMessenger" class="">TcoMessenger</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoCore/TcoLogger.html" title="TcoLogger" class="">TcoLogger</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">TcoData</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../TcOpenFramework/TcoData/Introduction.html" title="Introduction" class="">Introduction</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">Howto(s)</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../TcOpenFramework/howtos/How_to_get_started_using_tcopen_libraries/article.html" title="How to get started using TcOpen libraries" class="">How to get started using TcOpen libraries</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/howtos/How_to_write_a_sequence/article.html" title="How to write a sequence" class="">How to write a sequence</a>
                                </li>
                                <li class="">
                                  <a href="../../TcOpenFramework/howtos/How_to_include_tcopen_in_a_project/article.html" title="How to include TcOpen in a project" class="">How to include TcOpen in a project</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">TcOpen Inxton</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="../../Inxton/Colors_wpf.html" title="Colors Material Design WPF" class="">Colors Material Design WPF</a>
                          </li>
                          <li class="">
                            <a href="../../Inxton/InxtonConventions.html" title="Inxton Conventions" class="">Inxton Conventions</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">Inxton.Vortex.Framework.Blazor</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="../../Inxton/Inxton_vortex_framework_blazor/Inxton_vortex_framework_blazor.html" title="Introduction and installing" class="">Introduction and installing</a>
                                </li>
                                <li class="">
                                  <a href="../../Inxton/Inxton_vortex_framework_blazor/Renderablecontentcontrol.html" title="RenderableContentControl" class="">RenderableContentControl</a>
                                </li>
                                <li class="">
                                  <a href="../../Inxton/Inxton_vortex_framework_blazor/Layouts.html" title="Layouts" class="">Layouts</a>
                                </li>
                                <li class="">
                                  <a href="../../Inxton/Inxton_vortex_framework_blazor/Custom_libraries.html" title="Custom libraries" class="">Custom libraries</a>
                                </li>
                                <li class="">
                                  <a href="../../Inxton/Inxton_vortex_framework_blazor/Security.html" title="Security" class="">Security</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="sequencer">Sequencer</h1>

<p><strong>(TcoSequencer : ITcoSequencer)</strong></p>
<p><a href="../../../api/TcoCore/PlcDocu.TcoCore.TcoSequencer.html">API</a></p>
<p>The sequencer provides more advanced coordination of PLC logic. As the name suggests, the logic is organized in sequence. The steps run in the order in which they are written in the program.</p>
<p>The sequencer finds its use in any scenario where sequential control is appropriate (application or component).</p>
<p><code>TcoSequncer</code> is an abstract class, and it must have a concrete implementation of <code>Main</code> method. <code>Main</code> is the entry point for the sequence logic.</p>
<p>In addition to simple sequential coordination, this class permits manual step-by-step execution, moving the pointer backward and forward in the sequence. <code>TcoSequencer</code> also implements the auto-restorable mechanism analogous to <code>TcoState</code>.</p>
<pre><code class="lang-iecst">
FUNCTION_BLOCK MySequencer EXTENDS TcoCore.TcoSequencer
VAR
    _lightR_IsOn : BOOL;
    _lightG_IsOn : BOOL;
    _lightB_IsOn : BOOL;

    _lightR_SwitchOn : BOOL;
    _lightG_SwitchOn  : BOOL;
    _lightB_SwitchOn  : BOOL;

    _luminosityMin : REAL;
    _luminosity : REAL;
    _luminosityMax : REAL;    
END_VAR

(******************************************************)
METHOD PROTECTED FINAL Main

(******************************************************)
// Step header
IF Step(100,                                // Step id. Must be unique and must change at runtime.
        TRUE,                               // Indicates that whether the step should execute.
        'Switch all lights off') THEN       // Arbitrary step description (for SCADA/HMI)
//--------------------------------------------    
// Steps logic statements
    _lightR_SwitchOn := FALSE;
    _lightG_SwitchOn := FALSE;
    _lightB_SwitchOn := FALSE;

    IF(NOT _lightR_IsOn 
       AND NOT _lightG_IsOn 
       AND NOT _lightB_IsOn) 
    THEN
        CompleteStep(); // Completes step and moves to step 200
    END_IF;
//--------------------------------------------
END_IF;    

IF Step(200,
        TRUE,
        'Switch on red light') THEN
//--------------------------------------------    
    _lightR_SwitchOn := TRUE;
    IF(_lightR_IsOn) THEN
        CompleteStep();
    END_IF;
//--------------------------------------------
END_IF;

IF Step(300,
        TRUE,
        'Switch on green light') THEN
//--------------------------------------------    
    _lightG_SwitchOn := TRUE;
    IF(_lightG_IsOn) THEN
        CompleteStep();
    END_IF;
//--------------------------------------------
END_IF;

IF Step(400,
        TRUE,
        'Switch on blue light') THEN
//--------------------------------------------    
    _lightB_SwitchOn := TRUE;
    IF(_lightB_IsOn) THEN
        CompleteStep();
    END_IF;
//--------------------------------------------
END_IF;

IF Step(500,
        TRUE,
        'Check that all light are on') THEN
//--------------------------------------------        
    IF(_lightR_IsOn 
    AND _lightG_IsOn 
    AND _lightG_IsOn) 
    THEN
        CompleteStep();
    ELSE
        RequestStep(200); // Some light(s) is(are) not on, try again from 200    
    END_IF;
//--------------------------------------------
END_IF;


IF Step(600,
        TRUE,
        'Measure luminosity') THEN
//--------------------------------------------        
    IF(_luminosity_min =&lt; _luminosity AND _luminosity_max &gt;= _luminosity) THEN
        CompleteStep();
    ELSE
        RequestStep(500); // Luminosity is not where it should be; check again if the lights are on.    
    END_IF    
//--------------------------------------------
END_IF;

IF Step(800,
        TRUE,
        'Complete sequence') THEN
//--------------------------------------------        
        CompleteSequence(); // Returns to the first step (100) in the sequence.    
//--------------------------------------------
END_IF;
</code></pre>
<p><img src="assets/TcoSequecer-simple-transitions.png" alt=""></p>
<h4 id="requesting-step">Requesting step</h4>
<p><code>TcoSequener.RequestStep(INT)</code> it is similar to <code>goto</code> or <code>JMP</code> instructions, except that the jump occurs at the sequencer's level. If the requested step is past the step that made the request, the requested step will execute in the same PLC cycle. If the requested step is prior to the step where the request was issued, the step will execute in the next contexts cycle.</p>
<h4 id="cyclic-mode">Cyclic mode</h4>
<p>The <code>cyclic mode</code> runs the steps until it reaches the step in the sequence that invokes <code>CompleteSequence()</code> method; this method moves the sequencer's pointer to the first step in the sequence, it also registers the time of the sequence and prepares the sequencer for the next run.</p>
<h4 id="step-mode">Step mode</h4>
<p><code>Step mode</code> allows running step-by-step operations. At the transition from <code>Cyclic</code> to <code>Step</code> mode, the running step runs to completion, the sequencer's pointer moves to the next available step but does not run the step logic.</p>
<p>When <code>StepIn</code> task executes, the step runs its logic to the completion; the pointer moves to the next step but does not execute that step's logic.
Step mode allows moving the pointer of the sequence <code>forward</code> and <code>backward</code>; at each run of this commands running step's run terminates, and the pointer moves to the respective step.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/TcOpenGroup/TcOpen.Documentation/blob/dev/articles/TcOpenFramework/TcoCore/TcoSequencer.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <p>Generated by <strong>DocFX</strong> | Delivered by TcOpenGroup contributors</p>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
